# 软件工程与计算Ⅰ - 邵栋部分

> 本部分内容对应于最后一次课

## 守破离

### 软件工程教育、组织软件工程体系建设

#### 编程和软件工程之间的三个关键区别

##### 时间 

###### 代码的预期寿命：从分钟到无限期

代码的预期寿命不仅仅包括它的开发周期与维护周期，还有它的使用周期。

像编程作业这样短暂的系统实际上是“仅”⼀个编程问题，就像在⼀个维度上压缩⽴⽅体是⼀个正⽅形⼀样。

随着我们考虑软件存在的时间变⻓，改变变得越来越重要。 在⼗年或更⻓时间的跨度中，⼤多数程序依赖性（⽆论是隐 式还是显式，⽐如编译器、操作系统、硬件、⽹络）都可能 会改变。 

**这是我们区分软件⼯程和编程的根本。**

> ##### Google 2006年升级编译器
>
> 为什么要更新：计算成本与安全性问题；
>
> 升级⾮常痛苦：部分代码库代码对特定编译器版本具有依赖，⽽ 且当时也没有CI系统。

###### 海勒姆定律(Hyrum's Law)： -有⾜够数量的API⽤户，你在API⽂档中承诺的并不重要：系统的所有 可观察⾏为都将被某些⼈所依赖。

> BUG什么的是从来都不存在的，只有特性，特性，特性！🐕

##### 人数（规模）

软件工程与编程的差异⼀个维度是时间，另⼀个维度是人数。

> 手动关联《人月神话》
>
> - 没有银弹：复杂性是软件⼯程的第⼀属性！ 
> - 人月神话：沟通与⼈员规模扩⼤的问题。⼈员的增长和软件规模的增⻓带来的复杂度不是线性的。
>
> 软件的复杂度是内在的，不可消除的。在许多巨型项目中，占据主要开发人员时间的并不是具体的编码部分，因而没有任何工具上的提升能让软件开发效率有数量级上的提升。

##### 博弈（各种因素的权衡与取舍）

软件⼯程与编程的另外⼀个不同之处在于：需要作出决策的复杂性及其⻛险。

- 财务成本（例如：⾦钱）
- 资源成本（例如：CPU时间）
- ⼈员成本（例如：⼯程⼯作量）
- 交易成本（例如：采取⾏动需要多少费⽤） 
- 机会成本（例如：“不”采取⾏动要损失多少钱） 
- 社会成本（例如：这种选择会对整个社会产⽣什么影响）

###### 决策输入：数据驱动文化 

- 量化（估算） 
- 证据 
- 先例

“如果我花两周的时间将此链接列表改为更⾼性能的结构，我 将使⽤多出5GRAM，但要节省2000个CPU。我应该这么做吗？” 

- 这个问题不仅取决与RAM和CPU的相对成本，还取决与⼈员成本（⼯程师两周⼯作时间）和机会成本（⼯程师在两周内还能⽣产什么）。

#### 守破离

##### 守：保持、保护或维持。

- 建⽴技艺的基础。学⽣应当按照教授复制技术，不做⼀点修改，也不试图花精⼒理解技术背后的原理。 
- 守是⼀个合理的技术基础。 

##### 破：突破，打破流派传统进⾏⼀下扩展。

- 反省所学到内容的形式和⽬的，拥有⽐纯粹重复性练习更深⼊的理解。
- 思考这些技术背后的背景。

##### 离：超过或超越。 

- 独创地思考。从关于这⻔技艺的原始思想和背景知识出发有所发展，并基于实际情况来测试发展出的东⻄

## Software Engineering at Google

###  *【不是吧，不是吧，这都会考？】*

2017年1月31日，arXiv.org，Software Engineering at Google。

> We catalog and describe Google's key softwareengineering practices.

### 软件开发

#### 源码仓库

- 统一仓库
- Chrome仓库（开源）
- Android仓库（开源）

所有工程师都可以访问统一仓库（开源仓库自然也可以）。

- 几乎所有的开发活动都发生在仓库的“头部”而非分支，这样有助于尽快识别集成问题所在、极大地减小合并（merge）分支的工作
  量，还可以更快更容易地推出安全修复程序。

- 自动化测试系统频繁工作，通常在每次测试的传递依赖项中任何文件更改后运行。当某次变更更导致测试结果失败时，系统会在几分钟内自动通知变更提交者和评审员。
- 代码所有权。只有在被列出的仓库子树的所有者才能批准对子树的变更。确保每次变更都被了解这个软件的工程师所评审。



#### 构建系统

•⾕歌使用分布式系统Blaze来进编译、链接软件以及运⾏测试⽤例。

•任何⾕歌的软件⼯程师通常都可以⼗分简单迅捷地构建和测试仓库中的任何软件。

•单个的构建步骤必须是“封闭”的，它们仅仅依赖于声明的输⼊。

•单个的构建步骤是确定的。 •构建系统是可靠的。 

•构建结果，包括中间结果都缓存在云平台上。 

•增量重新构建是很快的。 

•提交前检查。



#### 代码评审

优秀的Web端代码评审⼯具。

让代码的编写者选择他们的评审员以防止评审员回复太慢或者极度不愿意赞成变更。

⼯程师们被⿎励保持较⼩的单个变更，并最好把⼤的变更分解成⼀系列更⼩的变更，以 便⼀个评审员能够⼀次性更简单地审阅。 

- ⼀种被⿎励的保持变更较⼩的⽅法是使⽤代码检查⼯具，⽤这次变更的⼤⼩标记每次代码评审。 对30-99⾏代码的添加/删除/移除的更改被标记为“中等⼤⼩”，对超过300⾏代码的变更被标记为 越来越贬低的标签，例如“⼤”（300-999）、“极其巨⼤”（1000-1999）等。



#### 测试

所有产品中使⽤的代码都被预期拥有单元测试，并且如果源⽂件在没有 对应的测试时被添加，代码检查⼯具会突出显示。代码评审员通常要求 任何增加新功能的更改都应该增加新的测试来覆盖新功能。部署前的负载测试在⾕歌也是必不可少的。



#### 缺陷追踪

一个完善的系统。



#### 编程语言

在⾕歌我们强烈⿎励软件⼯程师使⽤⾕歌官⽅批准的五种编程语 ⾔之⼀来编写程序：C++，Java，Python，Go或JavaScript。

统一的编程语言与编程风格。

过程的通⽤性仍是使开发变得容易的关键：只有⼀组命令来执⾏所有常⻅的软件⼯程任务 （⽐如检查、编辑、构建、测试、评审、提交、⽂件缺陷报告 等），并且相同的命令可以被⽆论什么项⽬或语⾔使⽤。



#### 调试和分析⼯具




#### 发布工程

对于⼤多数软件来说，发布是经常进⾏的。每周或每两周发布是常⻅的⽬标，有 些团队甚⾄每天发布。通过⾃动化⼤多数普通的发布⼯程任务使其成为可能。

Staging服务器（开发团队/极少数用户）→ 临时服务器（详情见下）→ Canary服务器（真实流量）→ 逐步推送到所有服务器

> 临时服务器：将来⾃⽣产流量的请求的副本（的⼀部分）发送到临时服务器，⽽ 且将这些相同的请求发送到当前的⽣产服务器以进⾏实际处理。临时服务器的响应被丢 弃，来⾃现场⽣产服务器的响应被发送回⽤户。



#### 上线批准

**任何⽤户可⻅的变更或重⼤设计变更的上线**都需要来⾃实施变更的核⼼⼯程团队之外的审批。某些特定批准（通常需经过详细审核），需要确保代码合规，符合法律，隐私，安全以 及可靠性⽅⾯的要求（例如具有适当的⾃动监控以检测服务 器中断并⾃动通知相关的⼯程师），以及业务需求等。（注意！后台的小改动可以不用！）



#### 事后剖析

重点是问题，如何在未来避免，⽽不是责任⼈或分摊责任。



#### 软件重构

每几年就来一次，确保技术栈及时更新。

### 项目管理

#### 20%的时间

⼯程师们被准许可以⽤百分之20的⼯作时间去选择做任何项⽬， 即使没有获得经理或他⼈的批准。

#### ⽬标与关键成果OKR

更好的解决KPI的单调性。

#### 项⽬审批

没有明确的审批流程。各级经理们对他们团队的项⽬负责并承担责任，同时⾏使他们认为合适的⾃由裁定权。

#### 组织重组



### 人员管理

#### ⼯程经理

唯⼀⼈员管理⻆⾊。⼯程经理通常是出⾃软件⼯程师，他们拥有相当⾼的专业技术能⼒。

技术主管和⼯程经理的职能有所区别。工程经理不仅负责选取技术主管，还负责为其选择团队。他们指导和协助 员⼯职业发展，以及做绩效评估（评估来⾃同⾏反馈，⻅下⽂），另 外负责⼀些补偿⽅⾯的事务。他们也负责做⼀些招聘⽅⾯的⼯作。他每个技术主管对⾃⼰项⽬的技术决策都有最终决定权。



#### 软件⼯程师(SWE)

管理他⼈也不是必需的升职条件。



#### 研究科学家



#### ⽹站可靠性⼯程师 (SRE)

运维



#### 产品经理



#### 项⽬经理 / 项⽬技术经理

### 办公条件好、培训好、内部转岗易与灵活的绩效考核与奖励。

•⼯程师可以给对⽅明确的反馈，通过“同⾏奖⾦”和“kudos”。

Google有⼀个⾮常仔细和详细的晋升过程，由⾃⼰或经理提名，⾃我审 查，同⾏评审，经理评价;然后由晋升委员会做出实际决定，结果可以由晋 升上诉委员会进⼀步审查。确保正确的⼈得到晋升⾄关重要，保持对员⼯的正确激励。

